{extend name='public/base' /}
{block name='content'}
{include file="blog@public/nav" /}

<section>
	<div class="container mt-15">
		<div class="row">
			<div class="col-lg-9 col-md-9">
				<div class="bk-gray">
					<div>
						<h3 class="text-c">{$article.title}</h3>
						<div class="text-c">
							<span><a href="{:url('blog/member/readMember',['id'=>$article.member.id])}"><i class="Hui-iconfont"> &#xe62c;</i> 作者：{$article.member.username}&nbsp;&nbsp; </a></span>
							<span><a href="javascript:"><i class="Hui-iconfont">&#xe728;</i> 时间：{$article.update_time}&nbsp;&nbsp; </a></span>
							<span><a href="{:url('blog/article/readArticle',['id'=>$article.id])}"><i class="Hui-iconfont">&#xe622;</i>评论：{$article.comment_num}&nbsp;&nbsp; </a></span>
							<span><a href="javascript:"><i class="Hui-iconfont">&#xe725;</i>浏览：{$article.click_num}&nbsp;&nbsp; </a></span>
							<span><a href="javascript:"><i class="Hui-iconfont">&#xe66d;</i>点赞：{$article.praise_num}</a></span>
						</div>
						<div class="text-l">
							<i class="Hui-iconfont">&#xe64b;</i>标签：
							{volist name='article.tags' id='tag'}
							{$tag.name}
							{/volist}
						</div>
					</div>
					<div class="bk-gray mt-15 pd-15">
						{$article.content|default="暂无内容"|raw}
					</div>
					<div class="bk-gray mt-15 pd-15">
						<h4 class="text-l"><strong><i class="Hui-iconfont">&#xe686; </i>文章评论</strong> </h4>
						<div class="bk-gray pd-15">
							<li>
								sdasd
							</li>
							<li>
								sadasqqw
							</li>
						</div>
						<div class="mt-15">
							<h4>发布评论</h4>
							<div id="article_comment"></div>
							<div class="text-r mt-10">
                                <button id="addComment" class="btn btn-primary radius"> 发表评论</button>
                            </div>
						</div>
					</div>
				</div>
			</div>
			<div class="col-lg-3 col-md-3">
				
			</div>
		</div>
	</div>
</section>

{/block}
{block name='javascript_content'}
<script>
    layui.use(['form', 'layedit', 'laydate', 'upload'], function () {
            var form = layui.form
                , layer = layui.layer
                , layedit = layui.layedit
                , upload = layui.upload
                , laydate = layui.laydate;

            //日期
            laydate.render({
                elem: '#date'
            });
            laydate.render({
                elem: '#date1'
            });

          
        }
    )
</script>
<script type="text/javascript">
    var E = window.wangEditor
    var editor = new E('#article_comment')
    editor.customConfig.menus = [
        // 'head',
        // 'bold',
        // 'italic',
        // 'underline',
        // 'foreColor',
        // 'backColor',
        // 'image',
        'emoticon',
        'code',
        'undo',
        'redo'
    ]
    editor.customConfig.uploadImgServer = '/upload'

    editor.create()

    //新增评论
    $("#addComment").click(function () {
        if (editor.txt.text() == '') {
            layer.msg('评论信息不可为空！', {icon: 2});
            return false;
        }
        $.ajax({
        	type:"post",
        	url:"{:url('blog/article/addComment')}",
        	async:false,
        	data:{
        		article_id: "{$article.id}",
            	comment_content: editor.txt.html(),
        	},
        	success:function(data){
        		layer.msg(data.msg, {icon: 0, time: 2000});
        		window.location.reload();
        	},
        	error:function(){
        		layer.msg('系统错误，稍后再试！', {icon: 0, time: 2000},function(){
        			window.parent.location.reload();
        		});
        	}
        });
    });

</script>
{/block}
